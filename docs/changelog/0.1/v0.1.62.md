# v0.1.62 - BUG-059: Fix Startup Reconciliation After Fresh Index

**Release Date:** 2026-01-08

## Summary

Fixes a bug where `amanmcp serve` would trigger unnecessary re-indexing after a fresh `amanmcp index` completed 100%. The root cause was that the gitignore hash was never saved by the index command, causing startup reconciliation to always think gitignore had changed.

---

## Fixed

- **BUG-059**: Fix startup reconciliation triggering after fresh index completion
  - Save gitignore hash after `amanmcp index` completes
  - Add ExcludePatterns to scanCurrentFiles() for consistency with index command
  - Export ComputeGitignoreHash and GitignoreHashKey for index command use

## Technical Details

### Root Cause

Two bugs combined:
1. `index.go` never saved the gitignore hash, so `ReconcileOnStartup()` always found empty cached hash
2. `scanCurrentFiles()` didn't pass ExcludePatterns, finding files that were excluded during original index

### Files Modified

- `internal/index/coordinator.go` - Export functions, add ExcludePatterns
- `cmd/amanmcp/cmd/index.go` - Save gitignore hash after completion
- `internal/index/coordinator_test.go` - 6 new regression tests

---

## Upgrade Notes

No action required. The fix is automatic - new indexes will save the gitignore hash properly.

---

## Documentation

- Add BUG-059 bug documentation
- Add RCA-014 root cause analysis

---

*Full changelog: [GitHub Releases](https://github.com/Aman-CERP/amanmcp/releases)*
