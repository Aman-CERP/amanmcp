# Version 0.1.35

**Release Date:** 2026-01-02
**Phase:** Maintenance Mode (61% complete)

---

## Summary

Maintenance release focused on embedding package and file locking improvements. All 4 items in the v0.1.35 "Embedding & Locks" theme have been resolved.

---

## Fixed

### DEBT-008: Double Lock in Close()
- Refactored `AdaptiveEmbedder.Close()` to use single lock acquisition
- Captures references under lock before releasing
- Prevents potential deadlock during shutdown

### DEBT-010: Batch Size Unbounded
- Added `ValidateBatchSize()` function with 1-256 range
- Updated `EmbedderConfig` defaults
- Batch size now clamped to valid range with warning

### DEBT-007: Lock Lifecycle Unclear
- Added `locked bool` field to `FileLock` struct
- `Unlock()` is now idempotent (safe to call multiple times)
- Added `IsLocked()` method for state inspection
- 3 new tests for lock lifecycle behavior

### DEBT-006: Windows flock Incompatibility
- Replaced Unix-only `syscall.Flock()` with cross-platform `gofrs/flock`
- No new dependencies (library was already indirect in go.mod)
- Works on Windows, macOS, and Linux
- Simpler implementation (95 lines vs 123 lines)

---

## Technical Details

### Files Modified

| File | Change |
|------|--------|
| `internal/embed/adaptive.go` | Single lock acquisition in Close() |
| `internal/embed/types.go` | ValidateBatchSize() function |
| `internal/embed/hugot.go` | Batch size validation |
| `internal/embed/lock.go` | gofrs/flock integration |
| `internal/embed/lock_test.go` | Lifecycle state tests |

### Quality Metrics

| Metric | Value |
|--------|-------|
| Tests | 11 lock tests passing |
| Coverage | 72.4% overall |
| CI Check | PASS |

---

## What's Next

- **v0.1.36: API Consistency** (4 items)
  - DEBT-013: Negative Cursor Accepted
  - DEBT-005: MarkdownChunker Missing Close
  - DEBT-014: File Close Error Suppressed
  - DEBT-012: Nil vs Empty Slice Returns

---

*Maintenance Mode: 11/18 items resolved (61%)*
