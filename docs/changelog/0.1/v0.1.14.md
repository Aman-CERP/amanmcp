# Version 0.1.14

**Release Date:** 2025-12-29
**Phase:** Phase 2 - MCP Integration (50% complete)

---

## Summary

F15 Query Classifier implements ML-based query classification that determines optimal BM25/semantic search weights for each query. Uses Ollama LLM for intelligent classification with pattern-based regex fallback.

---

## Added

- F15: Query Classifier - adaptive search weight selection
  - HybridClassifier: LLM-first with pattern fallback
  - LLMClassifier: Ollama `/api/generate` endpoint, llama3.2:1b model
  - PatternClassifier: Regex-based fallback (no external dependencies)
  - LRU Cache: hashicorp/golang-lru/v2, 1000 entries, normalized keys
  - Query normalization (lowercase, trim) for cache key generation
  - Configurable timeout (default 2s) and model selection

### Pattern Recognition

- Error codes: ERR_*, E0001, exceptions
- Quoted phrases: "..." and '...'
- File paths: .go, .ts, .py, .js, etc.
- Technical identifiers: camelCase, PascalCase, snake_case, SCREAMING_SNAKE
- Natural language: how, what, why, when, where, which, explain, describe, etc.
- Multi-word default: 3+ words → SEMANTIC, 1-2 words → MIXED

### Weight Mapping

| Query Type | BM25 Weight | Semantic Weight |
|------------|-------------|-----------------|
| LEXICAL | 0.85 | 0.15 |
| SEMANTIC | 0.20 | 0.80 |
| MIXED | 0.35 | 0.65 |

---

## Technical Details

### New Files

| File | Lines | Purpose |
|------|-------|---------|
| `internal/search/patterns.go` | 111 | PatternClassifier with regex patterns |
| `internal/search/classifier.go` | 305 | HybridClassifier, LLMClassifier |
| `internal/search/classifier_test.go` | 473 | Comprehensive TDD test suite |

### Modified Files

| File | Changes |
|------|---------|
| `internal/search/types.go` | Added QueryType, Classifier interface, WeightsForQueryType |
| `internal/search/engine.go` | WithClassifier option, classifier integration |
| `go.mod` | Added hashicorp/golang-lru/v2 v2.0.7 |

### Quality Metrics

| Metric | Value |
|--------|-------|
| Tests | 18 classifier tests passing |
| Coverage | 74.7% (internal/search) |
| Overall Coverage | 81.3% |
| Race Detector | Clean |
| CI Check | PASS |

---

## Dependencies

- `github.com/hashicorp/golang-lru/v2 v2.0.7` - Thread-safe LRU cache

---

## What's Next

- F16 (MCP Server Core) - Start MCP protocol implementation

---

*Phase 2: 3/6 features complete (50%)*
*Overall: 15/24 features complete (63%)*
