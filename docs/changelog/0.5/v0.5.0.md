# v0.5.0

**Release Date:** 2026-01-14

---

## Added

- **FEAT-QI4**: Go method receiver syntax patterns for query decomposition
  - Add patterns `) Name(`, `Name(ctx`, `func (name` to match Go method definitions
  - Improves matching for "X function" queries against Go methods like `func (e *Engine) Search()`
  - Patterns have highest weight (1.4-1.5) for precision

- **FEAT-QI5**: Adjacent chunk retrieval for context continuity
  - Add `AdjacentChunks` option to `SearchOptions` (default: 0 = disabled)
  - Top search results can include surrounding chunks from the same file
  - Add `AdjacentContext` field to `SearchResult` with `Before` and `After` chunks
  - Chunks sorted by proximity (closest to target first)
  - Improves "How does X work" query experience with implementation context

- **Validation Package**: MCP-based dogfooding test infrastructure
  - Add `internal/validation/` package for Tier 1/2 validation tests
  - Tests use MCP server directly, avoiding CLI/BoltDB locking issues
  - Add `make validate-tier1`, `make validate-tier2`, `make validate-all` targets
  - Add benchmarks for query performance tracking
  - Automatic skip when index is locked by another process

## Changed

- **ADR-037**: Switch default embedder from MLX to Ollama on all platforms
  - Ollama is now the default embedder (lower RAM usage, cross-platform)
  - MLX remains available as opt-in via `AMANMCP_EMBEDDER=mlx` or config
  - MLX is ~1.7x faster but consumes significantly more RAM
  - Supersedes ADR-035 (MLX as default on Apple Silicon)

## Fixed

_No bug fixes in this release._

## Removed

_No features removed in this release._

---

## Upgrade Notes

### Embedder Change (ADR-037)

If you were using the previous default (MLX on Apple Silicon), and want to continue using MLX for faster embeddings:

```bash
# Option 1: Environment variable
export AMANMCP_EMBEDDER=mlx

# Option 2: Config file (~/.config/amanmcp/config.yaml)
embedder: mlx
```

### Adjacent Chunk Retrieval (FEAT-QI5)

This feature is disabled by default. To enable it in your searches:

```go
results, err := engine.Search(ctx, query, &search.SearchOptions{
    AdjacentChunks: 1, // Include 1 chunk before and after each result
})
```

---

## Sprint Reference

This release completes Sprint 6 search quality improvements:
- FEAT-QI4: Go Method Syntax Patterns
- FEAT-QI5: Adjacent Chunk Retrieval
