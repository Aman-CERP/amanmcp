# v0.4.0

**Release Date:** 2026-01-13

---

## Added

- **FEAT-QI3**: Multi-Query Fusion for improved generic query handling. Pattern-based decomposition transforms queries like "How does RRF fusion work" into multiple specific sub-queries with parallel execution and consensus boosting. Improves Tier 1 validation from 75% to 83%.

## Fixed

- **BUG-049**: Fix BM25 index corruption after binary rebuild. Add index integrity validation on open with auto-recovery. Corrupted indices are now detected and cleared automatically with clear log messages prompting reindex.

---

## Upgrade Notes

No breaking changes. Upgrade is seamless.

### BM25 Index Auto-Recovery

If you encounter a corrupted BM25 index (empty `index_meta.json`), the new version will automatically detect and clear the corrupted index. You'll see a warning log:

```
WARN bm25_index_corrupted path=".amanmcp/bm25.bleve" error="index_meta.json is empty (corrupted)"
INFO bm25_index_cleared path=".amanmcp/bm25.bleve" reason="corruption detected, please reindex"
```

Simply run `amanmcp index .` to rebuild the index.

### Multi-Query Fusion

Generic queries like "How does RRF fusion work" now automatically decompose into multiple sub-queries for better coverage. This is transparent and requires no configuration changes.
